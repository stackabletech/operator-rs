---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: listenerclasses.listeners.stackable.tech
spec:
  group: listeners.stackable.tech
  names:
    categories: []
    kind: ListenerClass
    plural: listenerclasses
    shortNames: []
    singular: listenerclass
  scope: Cluster
  versions:
  - additionalPrinterColumns: []
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Auto-generated derived type for ListenerClassSpec via `CustomResource`
        properties:
          spec:
            description: |-
              Defines a policy for how [Listeners](https://docs.stackable.tech/home/nightly/listener-operator/listener) should be exposed.
              Read the [ListenerClass documentation](https://docs.stackable.tech/home/nightly/listener-operator/listenerclass)
              for more information.
            properties:
              loadBalancerAllocateNodePorts:
                default: true
                description: |-
                  Configures whether a LoadBalancer service should also allocate node ports (like NodePort).

                  Ignored unless serviceType is LoadBalancer.
                type: boolean
              loadBalancerClass:
                description: |-
                  Configures a custom Service loadBalancerClass, which can be used to access secondary
                  load balancer controllers that are installed in the cluster, or to provision
                  custom addresses manually.

                  Ignored unless serviceType is LoadBalancer.
                nullable: true
                type: string
              preferredAddressType:
                default: HostnameConservative
                description: |-
                  Whether addresses should prefer using the IP address (`IP`) or the hostname (`Hostname`).
                  Can also be set to `HostnameConservative`, which will use `IP` for `NodePort` service types, but `Hostname` for everything else.

                  The other type will be used if the preferred type is not available.

                  Defaults to `HostnameConservative`.
                enum:
                - Hostname
                - IP
                - HostnameConservative
                type: string
              serviceAnnotations:
                additionalProperties:
                  type: string
                default: {}
                description: Annotations that should be added to the Service object.
                type: object
              serviceExternalTrafficPolicy:
                anyOf:
                - description: |-
                    Service Internal Traffic Policy enables internal traffic restrictions to only route internal
                    traffic to endpoints within the node the traffic originated from. The "internal" traffic
                    here refers to traffic originated from Pods in the current cluster. This can help to reduce
                    costs and improve performance. See [Kubernetes docs][k8s-docs].

                    [k8s-docs]: https://kubernetes.io/docs/concepts/services-networking/service-traffic-policy/
                  enum:
                  - Cluster
                  - Local
                  type: string
                - enum:
                  - null
                  nullable: true
                description: |-
                  `externalTrafficPolicy` that should be set on the created Service objects.

                  It is a Kubernetes feature that controls how external traffic is routed to a Kubernetes
                  Service.

                  * `Cluster`: Kubernetes defaults to `Cluster`, which means that traffic is routed to any
                     node in the Kubernetes cluster that has a pod running the service.
                  * `Local`: Means that traffic is only routed to pods running on the same node as the
                     Service.

                  `Local` has a better performance as it avoids a network hop, but requires a "clever"
                  LoadBalancer, that respects what Pods run on which nodes and routes traffic only to that
                  nodes accordingly. Some cloud providers (such as IONOS) or bare metal installations
                  don't have such features, so the default is `Cluster` to work everywhere.
              serviceType:
                description: The method used to access the services.
                enum:
                - NodePort
                - LoadBalancer
                - ClusterIP
                type: string
            required:
            - serviceType
            type: object
        required:
        - spec
        title: ListenerClass
        type: object
    served: true
    storage: true
    subresources: {}
